const τ  = 6.2831853071795864769252867665590057683943387987502116419498891846156328125724179972560696506842341359642961730265646132941876892;
const τ18 = 0.7853981633974483096156608458198757210492923498437764552437361480769541015715522496570087063355292669955370216283205766617734611;
const τ14 = 1.5707963267948966192313216916397514420985846996875529104874722961539082031431044993140174126710585339910740432566411533235469223;
const τ12 = 3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446;
const τ34 = 4.7123889803846898576939650749192543262957540990626587314624168884617246094293134979420522380131756019732221297699234599706407669;


function refAng(a) //reference angle of a positive input angle "a"
{
  let ra;
  if (a <= τ14) { ra = a; }
  else if (a > τ14 && a <= τ12) { ra = τ12 - a; }
  else if (a > τ12 && a <= τ34) { ra = a - τ12; }
  else if (a > τ34 && a <= τ) { ra = τ - a; }
  else if (a > τ) { ra = refAng( ( (a / τ) - Math.floor(a / τ) ) * τ ); }
  return ra;
}

function cfoz(x)
{
  let wx = refAng( Math.abs(x) ), oz;
  if (wx > τ18) { oz = cfzo( τ14 - wx ); }
  else
  {
    oz = 1 - x**2 / 2 + x**4 / 24;
  }
  return oz;
}

function cfzo(x)
{
  let wx = refAng( Math.abs(x) ), s = Math.sign(x), zo;
  if (wx > τ18) { zo = cfoz( τ14 - wx ); }
  else
  {
    zo = x - x**3 / 6 + x**5 / 120;
  }
  return s * zo;
}
